# 插件错误码规范

## 总体要求 <a id="%E6%80%BB%E4%BD%93%E8%A6%81%E6%B1%82"></a>

* 插件开发者需对导致插件执行失败的各种场景进行细分，使用错误码（errorCode）进行标识，并在插件日志、使用指引中给出详细的描述和解决方法，方便用户快速定位和解决问题
* 插件开发者需对导致插件执行失败的错误进行归类，指定错误类型 errorType，用于度量统计

## 错误类型和错误码规范 <a id="%E9%94%99%E8%AF%AF%E7%B1%BB%E5%9E%8B%E5%92%8C%E9%94%99%E8%AF%AF%E7%A0%81%E8%A7%84%E8%8C%83"></a>

### 1 插件错误类型（errorType） <a id="1-%E6%8F%92%E4%BB%B6%E9%94%99%E8%AF%AF%E7%B1%BB%E5%9E%8Berrortype"></a>

通过插件结果中的 errorType 字段上报：

| 错误类型 | 取值 | 含义 | 详细说明 |
| :--- | :--- | :--- | :--- |
| USER | 1 | 用户配置错误 | 用户在流水线配置的插件参数有误，或是用户业务逻辑出错 |
| THIRD\_PARTY | 2 | 第三方系统错误 | 非 bkci 的其他平台接口调用出错，如：第三方镜像平台接口错误、作业平台接口错误、织云上传接口请求失败等 |
| PLUGIN | 3 | 插件执行错误（默认） | 插件执行逻辑出错，需开发者跟进和修复，插件开发者有义务将PLUGIN错误细分为其他类型 |

注：插件SDK只提供1-3的传值枚举，插件结果内未指定或指定1-3以外的值，则错误类型取值为3（插件执行错误）

### 2 插件错误码（errorCode） <a id="2-%E6%8F%92%E4%BB%B6%E9%94%99%E8%AF%AF%E7%A0%81errorcode"></a>

通过插件结果中的 errorCode 字段上报：

| 取值 | 含义 | 详细说明 |
| :--- | :--- | :--- |
| 2199001 | 默认错误码 | 插件开发者未指定错误码时将使用 bkci 平台规范的插件默认错误码 |
| 自定义 | 插件开发者定义的错误码 | 插件开发者按所处团队/平台使用的规范定义，可用于后期插件/构建的数据度量 |

注：插件错误码有助于开发者定义完整的、成体系的错误信息，方便问题定位和报表生成

